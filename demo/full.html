<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>CBFimage</title>
<style>
body, canvas, div {
	margin: 0;
	padding: 0;
}
html, body {
    background: #fff;
    height: 100%;
}
body {
    position: relative;
    background: #333946;
}
#loading {
    background: rgba(0,0,0,.1);
    height: 100%;
    position: absolute;
    left: 0;
    top: 0;
    width: 0;
    -webkit-transition: width .1s ease-in-out;
    -moz-transition: width .1s ease-in-out;
    transition: width .1s ease-in-out;
}
</style>
</head>
<body>
<canvas id="canvas" url="alma.jpg" version="0" blur="0"></canvas>

<script src="../CBFimage.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() { 
    CBFimage({
        id: 'canvas',
        cache: false,
        start: function() {
            document.getElementById('canvas').insertAdjacentHTML('afterend', '<div id="loading"></div>')
        },
        progress: function(loaded, total) {
            document.getElementById('loading').style.width = loaded / total * window.innerWidth +'px';
        },
        end: function() {
            document.getElementById('loading').parentNode.removeChild(document.getElementById('loading'))
        }
    })
})
</script>
</body>
</html>
